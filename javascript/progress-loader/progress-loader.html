    
 <!--  note: try setting a timeout on this to get it to work with numbers -->
<!-- http://jsfiddle.net/WpJxn/1/ -->


<style>
  .preload {
    background-color: rgba(0,0,0,1);
    transition: opacity 0.5s;
    position: fixed;
    width: 100vw;
    height: 100vh;
    right: 0;
    left: 0;
    opacity: 1;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;

  }

  .preload .progress-counter {
    font-size: 2em;
    opacity: 0.5;
    display: none;
  }
  .preload.loaded {
    opacity: 0;
    visibility: hidden;
  }
</style>



    <script type="text/javascript">
      document.onreadystatechange = function(e) {

      //add window contentLoaded event
      var ContentLoadedEvent = CustomEvent("contentLoaded", { bubbles: false, cancelable: false, detail: {}});


      var all = document.getElementsByTagName("*");
      var tracker = document.getElementById("progress_width");
      var displayPercent = document.querySelector(".progress-counter");

        if(document.readyState == "interactive")
        {
          var all = document.getElementsByTagName("*");
          for (var i = 0, max = all.length; i < max; i++) 
          {
            set_ele(all[i]);
          }
        }

        function check_element(ele) {
          var totalele = all.length;
          var per_inc = 100/all.length;

          if($(ele).on()) {
            //var prog_width=per_inc+Number(tracker.value);
            //tracker.value=prog_width;

            // $("#bar1").animate({width:prog_width+"%"},10,function(){
            //   if(document.getElementById("bar1").style.width=="100%")
            //   {
            //     $(".progress").fadeOut("slow");
            //   }     
            // });
            var prog_width=per_inc+Number(tracker.value);
            tracker.value=prog_width;

            var outputDisplay = parseInt(prog_width);
            displayPercent.textContent = outputDisplay;

            if (prog_width > 99.99) {
               //loaded... (needs additional settimeout to work)
               setTimeout(function() {
                 window.dispatchEvent(ContentLoadedEvent);
               }, 100);
            }
          } else {
            set_ele(ele);
          }
        }

        function set_ele(set_element) {
          check_element(set_element);
        }
      }
    </script>


      <!-- Loading progress counter -->
      <div class="preload">
          <div class="progress-counter"></div>
      </div>

      <!-- progress bar -->
    <!--   <div class='progress' id="progress_div">
        <div class='bar' id='bar1'></div>
        <div class='percent' id='percent1'></div>
      </div> -->

      <!-- Loading progress data holder-->
      <input type="hidden" id="progress_width" value="0">